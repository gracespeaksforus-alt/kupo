{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}
{% block page_title %}Overview{% endblock %}
{% block topbar_action %}+ New Report{% endblock %}

{% block content %}

<!-- Summary Cards -->
<div class="cards-grid">
  <div class="card card--blue">
    <div class="card-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/></svg>
    </div>
    <div class="card-body">
      <span class="card-label">Total Users</span>
      <span class="card-value">{{ stats.total_users }}</span>
    </div>
    <div class="card-footer">+{{ stats.new_this_month }} this month</div>
  </div>

  <div class="card card--green">
    <div class="card-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
    </div>
    <div class="card-body">
      <span class="card-label">Active Users</span>
      <span class="card-value">{{ stats.active_users }}</span>
    </div>
    <div class="card-footer">{{ ((stats.active_users / stats.total_users) * 100) | round(1) }}% of total</div>
  </div>

  <div class="card card--yellow">
    <div class="card-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
    </div>
    <div class="card-body">
      <span class="card-label">Pending</span>
      <span class="card-value">{{ stats.pending_users }}</span>
    </div>
    <div class="card-footer">Awaiting activation</div>
  </div>

  <div class="card card--purple">
    <div class="card-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="20" x2="12" y2="4"/><polyline points="6 10 12 4 18 10"/></svg>
    </div>
    <div class="card-body">
      <span class="card-label">New This Month</span>
      <span class="card-value">{{ stats.new_this_month }}</span>
    </div>
    <div class="card-footer">+18% vs last month</div>
  </div>
</div>

<!-- Bottom panels -->
<div class="panels-grid">

  <!-- Recent Users table -->
  <section class="panel">
    <div class="panel-header">
      <h2 class="panel-title">Recent Users</h2>
      <a href="{{ url_for('users') }}" class="panel-link">View all &rarr;</a>
    </div>
    <table class="table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Role</th>
          <th>Status</th>
          <th>Joined</th>
        </tr>
      </thead>
      <tbody>
        {% for u in recent_users %}
        <tr>
          <td>
            <div class="user-cell">
              <div class="mini-avatar">{{ u.name[0] }}</div>
              <div>
                <div class="cell-name">{{ u.name }}</div>
                <div class="cell-sub">{{ u.email }}</div>
              </div>
            </div>
          </td>
          <td>{{ u.role }}</td>
          <td><span class="badge badge--{{ u.status | lower }}">{{ u.status }}</span></td>
          <td class="text-muted">{{ u.joined }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>

  <!-- Recent Activity -->
  <section class="panel">
    <div class="panel-header">
      <h2 class="panel-title">Recent Activity</h2>
    </div>
    <ul class="activity-list">
      {% for item in activity %}
      <li class="activity-item">
        <div class="activity-dot"></div>
        <div class="activity-content">
          <span class="activity-user">{{ item.user }}</span>
          <span class="activity-action"> {{ item.action }}</span>
          <span class="activity-time">{{ item.time }}</span>
        </div>
      </li>
      {% endfor %}
    </ul>
  </section>

</div>
{% endblock %}
